@model UserProfile
@{
    ViewData["Title"] = "CV - " + (Model?.User?.FullName ?? "Unknown");
    Layout = null; // No layout for clean CV view
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
        }
        
        .cv-container {
            max-width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            display: flex;
            overflow: hidden;
        }
        
        .cv-sidebar {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3d72 100%);
            color: white;
            width: 35%;
            padding: 40px 30px;
            position: relative;
        }
        
        .cv-main {
            flex: 1;
            padding: 40px 35px;
            background: white;
        }
        
        .profile-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid rgba(255,255,255,0.3);
            margin: 0 auto 30px;
            display: block;
            object-fit: cover;
        }
        
        .profile-name {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .profile-title {
            text-align: center;
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 40px;
            font-weight: 300;
        }
        
        .sidebar-section {
            margin-bottom: 35px;
        }
        
        .sidebar-section h3 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .contact-item i {
            width: 20px;
            margin-right: 15px;
            text-align: center;
        }
        
        .skill-item {
            margin-bottom: 15px;
        }
        
        .skill-name {
            font-size: 13px;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .skill-bar {
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .skill-progress {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 3px;
        }
        
        .main-section {
            margin-bottom: 35px;
        }
        
        .main-section h2 {
            color: #2c5aa0;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #2c5aa0;
            padding-bottom: 5px;
        }
        
        .summary-text {
            font-size: 14px;
            line-height: 1.6;
            color: #555;
            text-align: justify;
        }
        
        .experience-item, .education-item {
            margin-bottom: 25px;
            position: relative;
            padding-left: 20px;
        }
        
        .experience-item::before, .education-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 8px;
            height: 8px;
            background: #2c5aa0;
            border-radius: 50%;
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .item-title {
            font-weight: bold;
            color: #333;
            font-size: 15px;
        }
        
        .item-company {
            color: #2c5aa0;
            font-weight: 600;
            font-size: 14px;
        }
        
        .item-date {
            color: #666;
            font-size: 12px;
            font-style: italic;
        }
        
        .item-description {
            color: #555;
            font-size: 13px;
            line-height: 1.5;
            margin-top: 5px;
        }
        
        .awards-list {
            list-style: none;
            padding: 0;
        }
        
        .awards-list li {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .awards-list li::before {
            content: 'üèÜ';
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        @@media print {
            body {
                background: white;
                padding: 0;
            }
            
            .cv-container {
                box-shadow: none;
                max-width: none;
                min-height: auto;
            }
            
            .print-button {
                display: none;
            }
        }
        
        .profession-tag {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 11px;
            margin: 2px;
            border: 1px solid rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>
    <button class="btn btn-primary print-button" onclick="window.print()">
        <i class="fas fa-print"></i> In CV
    </button>
    
    <div class="cv-container">
        <!-- Sidebar -->
        <div class="cv-sidebar">
            <!-- Profile Photo -->
            @if (!string.IsNullOrEmpty(Model?.User?.Avata))
            {
                <img src="@Model.User.Avata" alt="Profile Photo" class="profile-photo" />
            }
            else
            {
                <img src="~/images/default-avatar.svg" alt="Profile Photo" class="profile-photo" />
            }
            
            <!-- Name and Title -->
            <div class="profile-name">@(Model?.User?.FullName ?? "T√™n kh√¥ng c√≥")</div>
            <div class="profile-title">
                @if (Model?.UserProfileProfessions?.Any() == true)
                {
                    @string.Join(", ", Model.UserProfileProfessions.Take(2).Select(p => p.Profession?.ProfessionName))
                }
                else
                {
                    <text>Chuy√™n gia</text>
                }
            </div>
            
            <!-- Contact -->
            <div class="sidebar-section">
                <h3>Li√™n h·ªá</h3>
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>@(Model?.User?.Email ?? "email@example.com")</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-phone"></i>
                    <span>@(Model?.User?.PhoneNumber ?? "+84 xxx xxx xxx")</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>@(Model?.Location ?? "Vi·ªát Nam")</span>
                </div>
                @if (Model?.ExpectedSalary.HasValue == true)
                {
                    <div class="contact-item">
                        <i class="fas fa-dollar-sign"></i>
                        <span>@Model.ExpectedSalary.Value.ToString("N0") VNƒê</span>
                    </div>
                }
            </div>
            
            <!-- Skills -->
            @if (Model?.UserProfileSkills?.Any() == true)
            {
                <div class="sidebar-section">
                    <h3>K·ªπ nƒÉng</h3>
                    @foreach (var skill in Model.UserProfileSkills.Take(8))
                    {
                        <div class="skill-item">
                            <div class="skill-name">@skill.Skill?.SkillName</div>
                            <div class="skill-bar">
                                <div class="skill-progress" style="width: @(new Random().Next(70, 95))%"></div>
                            </div>
                        </div>
                    }
                </div>
            }
            
            <!-- Professions -->
            @if (Model?.UserProfileProfessions?.Any() == true)
            {
                <div class="sidebar-section">
                    <h3>Chuy√™n m√¥n</h3>
                    @foreach (var profession in Model.UserProfileProfessions)
                    {
                        <div class="profession-tag">@profession.Profession?.ProfessionName</div>
                    }
                </div>
            }
        </div>
        
        <!-- Main Content -->
        <div class="cv-main">
            <!-- Summary -->
            @if (!string.IsNullOrEmpty(Model?.Summary))
            {
                <div class="main-section">
                    <h2>T√≥m t·∫Øt</h2>
                    <div class="summary-text">
                        @Model.Summary
                    </div>
                </div>
            }
            
            <!-- Experience -->
            @if (Model?.WorkExperiences?.Any() == true)
            {
                <div class="main-section">
                    <h2>Kinh nghi·ªám</h2>
                    @foreach (var exp in Model.WorkExperiences.OrderByDescending(e => e.StartDate))
                    {
                        <div class="experience-item">
                            <div class="item-header">
                                <div>
                                    <div class="item-title">@exp.WorkName</div>
                                    <div class="item-company">@exp.CompanyName</div>
                                </div>
                                <div class="item-date">
                                    @if (exp.StartDate.HasValue)
                                    {
                                        @exp.StartDate.Value.ToString("MM/yyyy")
                                    }
                                    -
                                    @if (exp.EndDate.HasValue)
                                    {
                                        @exp.EndDate.Value.ToString("MM/yyyy")
                                    }
                                    else
                                    {
                                        <text>Hi·ªán t·∫°i</text>
                                    }
                                </div>
                            </div>
                            @if (!string.IsNullOrEmpty(exp.WorkDescription))
                            {
                                <div class="item-description">@exp.WorkDescription</div>
                            }
                        </div>
                    }
                </div>
            }
            
            <!-- Education -->
            @if (Model?.Degrees?.Any() == true)
            {
                <div class="main-section">
                    <h2>H·ªçc v·∫•n</h2>
                    @foreach (var degree in Model.Degrees.OrderByDescending(d => d.GraduationYear))
                    {
                        <div class="education-item">
                            <div class="item-header">
                                <div>
                                    <div class="item-title">@degree.DegreeName</div>
                                    <div class="item-company">@degree.SchoolName</div>
                                    @if (!string.IsNullOrEmpty(degree.Major))
                                    {
                                        <div style="color: #666; font-size: 13px;">Chuy√™n ng√†nh: @degree.Major</div>
                                    }
                                </div>
                                @if (degree.GraduationYear.HasValue)
                                {
                                    <div class="item-date">@degree.GraduationYear</div>
                                }
                            </div>
                        </div>
                    }
                </div>
            }
            
            <!-- Certificates -->
            @if (Model?.Certificates?.Any() == true)
            {
                <div class="main-section">
                    <h2>Ch·ª©ng ch·ªâ</h2>
                    <ul class="awards-list">
                        @foreach (var cert in Model.Certificates.OrderByDescending(c => c.IssueDate))
                        {
                            <li>
                                <strong>@cert.CertificateName</strong> - @cert.IssueBy
                                @if (cert.IssueDate.HasValue)
                                {
                                    <span style="color: #666; font-size: 12px;">(@cert.IssueDate.Value.ToString("MM/yyyy"))</span>
                                }
                            </li>
                        }
                    </ul>
                </div>
            }
        </div>
    </div>
    
    <script>
        // Auto-adjust skill bars with animation
        document.addEventListener('DOMContentLoaded', function() {
            const skillBars = document.querySelectorAll('.skill-progress');
            skillBars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.transition = 'width 1s ease-in-out';
                    bar.style.width = width;
                }, 100);
            });
        });
    </script>
</body>
</html>