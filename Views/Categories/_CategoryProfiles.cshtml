@model IEnumerable<finder_work.Models.UserProfile>

<div id="profiles-content">
    @if (Model != null && Model.Any())
    {
        @foreach (var profile in Model)
        {
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="profile-card h-100">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-4">
                            <!-- Profile Header -->
                            <div class="d-flex align-items-center mb-3">
                                <div class="profile-avatar me-3">
                                    @if (!string.IsNullOrEmpty(profile.User?.Avata))
                                    {
                                        <img src="@profile.User.Avata" alt="@profile.User.FullName" 
                                             class="rounded-circle" width="60" height="60" style="object-fit: cover;">
                                    }
                                    else
                                    {
                                        <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center text-white fw-bold" 
                                             style="width: 60px; height: 60px; font-size: 1.5rem;">
                                            @(profile.User?.FullName?.FirstOrDefault().ToString().ToUpper() ?? "U")
                                        </div>
                                    }
                                </div>
                                <div class="flex-grow-1">
                                    <h5 class="card-title mb-1">@profile.User?.FullName</h5>
                                    <p class="text-muted mb-0">
                                        <i class="bi bi-geo-alt me-1"></i>@profile.Location
                                    </p>
                                </div>
                            </div>

                            <!-- Summary -->
                            <div class="mb-3">
                                <p class="card-text text-muted">
                                    @if (!string.IsNullOrEmpty(profile.Summary))
                                    {
                                        @(profile.Summary.Length > 120 ? profile.Summary.Substring(0, 120) + "..." : profile.Summary)
                                    }
                                </p>
                            </div>

                            <!-- Skills -->
                            @if (profile.UserProfileSkills?.Any() == true)
                            {
                                <div class="mb-3">
                                    <h6 class="text-muted mb-2">Kỹ năng:</h6>
                                    <div class="skills-container">
                                        @foreach (var skill in profile.UserProfileSkills.Take(3))
                                        {
                                            <span class="badge bg-primary me-1 mb-1">@skill.Skill?.SkillName</span>
                                        }
                                        @if (profile.UserProfileSkills.Count() > 3)
                                        {
                                            <span class="badge bg-light text-dark">+@(profile.UserProfileSkills.Count() - 3)</span>
                                        }
                                    </div>
                                </div>
                            }

                            <!-- Professions -->
                            @if (profile.UserProfileProfessions?.Any() == true)
                            {
                                <div class="mb-3">
                                    <h6 class="text-muted mb-2">Ngành nghề:</h6>
                                    <div class="professions-container">
                                        @foreach (var profession in profile.UserProfileProfessions.Take(2))
                                        {
                                            <span class="badge bg-secondary me-1 mb-1">@profession.Profession?.ProfessionName</span>
                                        }
                                        @if (profile.UserProfileProfessions.Count() > 2)
                                        {
                                            <span class="badge bg-light text-dark">+@(profile.UserProfileProfessions.Count() - 2)</span>
                                        }
                                    </div>
                                </div>
                            }

                            <!-- Salary -->
                            @if (profile.ExpectedSalary.HasValue)
                            {
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">Mức lương mong muốn:</h6>
                                    <span class="fw-bold text-success">@profile.ExpectedSalary.Value.ToString("N0") VND</span>
                                </div>
                            }

                            <!-- Updated Date -->
                            <div class="mb-3">
                                <small class="text-muted">
                                    <i class="bi bi-clock me-1"></i>
                                    Cập nhật: @profile.UpdatedDate.ToString("dd/MM/yyyy")
                                </small>
                            </div>
                        </div>

                        <!-- Card Footer -->
                        <div class="card-footer bg-transparent border-top-0 p-4 pt-0">
                            <div class="d-grid">
                                <a href="@Url.Action("ProfileDetail", "Home", new { id = profile.ProfileId })" 
                                   class="btn btn-outline-primary">
                                    <i class="bi bi-eye me-2"></i>Xem hồ sơ
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12 text-center py-5">
            <div class="text-muted">
                <i class="bi bi-person-x display-1 mb-3"></i>
                <h4>Chưa có hồ sơ nào trong danh mục này</h4>
                <p>Hãy quay lại sau để xem các hồ sơ ứng viên mới nhất.</p>
            </div>
        </div>
    }
</div>

<!-- Pagination -->
<div class="col-12">
    <partial name="_Pagination" />
</div>